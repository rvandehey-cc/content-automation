#!/bin/sh


current_branch=$(git rev-parse --abbrev-ref HEAD)

if [ "$current_branch" = "main" ] || [ "$current_branch" = "dev" ]; then
  echo "ğŸ›¡ï¸ Pushing to protected branch '$current_branch' - running validations..."
  
  echo "ğŸ§ª Running tests with coverage..."
  if ! npm run test:coverage; then
    echo "âŒ Tests failed. Push blocked."
    exit 1
  fi
  
  echo "ğŸ§¹ Running linting..."
  if ! npm run lint; then
    echo "âŒ Linting failed. Push blocked."
    exit 1
  fi

  echo "ğŸ§¹ Running web linting..."
  # if ! npm run lint:web; then
  #   echo "âŒ Web Linting failed. Push blocked."
  #   exit 1
  # fi
  echo "âš ï¸ Web linting skipped (configuration pending)"

  echo "âœ… All pre-push checks passed!"
fi
